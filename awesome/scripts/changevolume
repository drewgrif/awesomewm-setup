#!/bin/bash

function send_notification() {
    volume=$(pamixer --get-volume)
    # Create a notification through awesome-client using naughty
    lua_command="
    local naughty = require('naughty')
    naughty.notify({
        title = 'Volume',
        text = 'Volume: ${volume}%',
        icon = 'volume-$1',
        preset = naughty.config.presets.low,
        replaces_id = 9993,
        timeout = 2
    })
    "
    echo "$lua_command" | awesome-client
}

case $1 in
up)
    # Set the volume on (if it was muted)
    pamixer -u
    pamixer -i 2 --allow-boost
    send_notification $1
    ;;
down)
    pamixer -u
    pamixer -d 2 --allow-boost
    send_notification $1
    ;;
mute)
    pamixer -t
    if $(pamixer --get-mute); then
        # Create a mute notification
        lua_command="
        local naughty = require('naughty')
        naughty.notify({
            title = 'Volume',
            text = 'Muted',
            icon = 'volume-mute',
            preset = naughty.config.presets.low,
            replaces_id = 9993,
            timeout = 2
        })
        "
        echo "$lua_command" | awesome-client
    else
        send_notification up
    fi
    ;;
esac
